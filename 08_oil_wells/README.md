# Выбор локации для скважины

Вы работаете в добывающей компании «ГлавРосГосНефть». Нужно решить, где бурить новую скважину. 
Шаги для выбора локации обычно такие:
- В избранном регионе собирают характеристики для скважин: качество нефти и объём её запасов;
- Строят модель для предсказания объёма запасов в новых скважинах;
- Выбирают скважины с самыми высокими оценками значений;
- Определяют регион с максимальной суммарной прибылью отобранных скважин.

Вам предоставлены пробы нефти в трёх регионах. Характеристики для каждой скважины в регионе уже известны. 

Данные геологоразведки трёх регионов находятся в файлах: 

- geo_data_0.csv
- geo_data_1.csv
- geo_data_2.csv

- id — уникальный идентификатор скважины;
- f0, f1, f2 — три признака точек (неважно, что они означают, но сами признаки значимы);
- product — объём запасов в скважине (тыс. баррелей).

Условия задачи:
- Для обучения модели подходит только линейная регрессия (остальные — недостаточно предсказуемые).
- При разведке региона исследуют 500 точек, из которых с помощью машинного обучения выбирают 200 лучших для разработки.
- Бюджет на разработку скважин в регионе — 10 млрд рублей.
- При нынешних ценах один баррель сырья приносит 450 рублей дохода. Доход с каждой единицы продукта составляет 450 тыс. рублей, поскольку объём указан в тысячах баррелей.
- После оценки рисков нужно оставить лишь те регионы, в которых вероятность убытков меньше 2.5%. Среди них выбирают регион с наибольшей средней прибылью.

Данные синтетические: детали контрактов и характеристики месторождений не разглашаются.

## Цель исследования:

Построить модель для определения региона, где добыча принесёт наибольшую прибыль. Проанализировать возможную прибыль и риски техникой Bootstrap.

## Итог исследования:

На первом шаге, был проведен анализ данных, проверены уникальные значения и наличие дубликатов, проведена проверка корреляции признаков, стоит отметить стабильно высокие показатели между "f2" и "product" в каждом из наборов данных. Для второго набора (Регион 2) данных такая связь очень высокая, значение близко к 1.

После первого этапа была проведена процедура формирования обучающих и валидационных выборок в соотношении 75:25, количественных признаков были промасштабированы. Разработаны и обучены три модели Линейной регрессии, параметры подобраны с помощью GridSearchCV для каждого датасета. Наилучшими прогнозными свойствами обладает модель линейной регрессии с параметрами

- 'copy_X': True
- fit_intercept': True
- 'normalize': True

|   | Среднее предсказанное, тыс.баррелей | Среднее фактическое, тыс.баррелей | Среднее фактическое, тыс.баррелей | RMSE | R2 | MAE |
|--|--|--|--|--|--|--|
|Регион 1| 92.59 | 92.50 | 0.10 | 37.58 | 0.28 | 30.92 |
|Регион 2| 68.73 | 68.83 | -0.15 | 0.89 | 1.00 | 0.72 |
|Регион 3| 94.97 | 95.00 | -0.03 | 40.03 | 0.21 | 32.79 |

Модель хорошо предсказывает среднюю мощность скважин, отклонения по регионам от 0,03 до 0,15%. Несмотря на низкое значение предсказанных и фактических показателей добычи, в лидеры вырывается регион 2, со следующими метриками

- RMSE = 0.89
- MAE = 0.72
- коэффициент детерминации R2 = 1.0.
После определения переменных для ключевых значений, был произведен расчет достаточный объём сырья для безубыточной разработки новой скважины. Он составил 111.11 тыс. баррелей. Согласно прогнозам, такой среднего объема добычи не достигается ни в одном регионе.

Отсортировав 200 скважин с наибольшей мощностью в каждом регионе, были произведены подсчеты прибыли за вычетом расходов на разработку по фактическим данным.

Прибыль для полученного объёма баррелей нефти в первом регионе: 3.3205 млрд.руб.
Прибыль для полученного объёма баррелей нефти во втором регионе: 2.4151 млрд.руб.
Прибыль для полученного объёма баррелей нефти в третьем регионе: 2.7102 млрд.руб.

Согласно требованиям провести геологоразведку разрешено только по 500 точкам. Поэтому на следующем этапе, применив методику Bootstrap, было проанализировано, как изменится прибыль исходя из данного ограничения.

Средняя прибыль Регион 1: 396.16 млн.руб.
Вероятность убытков равна 6.90%

Средняя прибыль Регион 2: 456.05 млн.руб.
Вероятность убытков равна 1.50%

Средняя прибыль Регион 3: 404.40 млн.руб.
Вероятность убытков равна 7.60%

Несмотря на лидерство первого региона на большой выборке, существуют высокая вероятность убытков разрабатывать в этом регионе 6,9%.

После применения техники Bootstrap с 1000 выборок, стало ясно, что регион 2, будет предпочтительнее, так как вероятность убытков составляет 1.5%, к тому же в пределах 95%-доверительного интервала добыча все равно остаётся безубыточной. Средняя прибыль выше, чем в остальных регионах и составляет 456.05 млн.руб..

## Стек технологий:

`pandas`, `matplotlib`, `numpy`, `seaborn`, `scikit-learn`

## Статус проекта:

Завершен.
