# Отток клиентов банка

Из «Бета-Банка» стали уходить клиенты. Каждый месяц. Немного, но заметно. Банковские маркетологи посчитали: сохранять текущих клиентов дешевле, чем привлекать новых.

## Цель исследования:

Нужно спрогнозировать, уйдёт клиент из банка в ближайшее время или нет. Вам предоставлены исторические данные о поведении клиентов и расторжении договоров с банком.

Построить модель с предельно большим значением F1-меры. Чтобы сдать проект успешно, нужно довести метрику до значения 0.59.

## Ход исследования:

1. Загружены и подготовлены данные. 
2. Исследован баланс классов, и обучена модель без учёта дисбаланса, с описанием выводов.
3. Улучшение качества модели, учитывая дисбаланс классов. Обучены разные модели и найдена лучшая.
4. Проведено финальное тестирование.

Было изучено и применено:
* Работа с новыми метриками классификации: точностью, полнотой, F1-мерой и AUC-ROC.
* Взвешивание классов, уменьшение и увеличение выборки, а также настройка порогов в классификации.
* В задачах регрессии оценка качества модели новыми метриками: R2 и MAE.

## Итог исследования:

Методом прямого кодирования преобразован весь датафрейм, что позволило избежать дамми-ловушки.

Данные были разбиты на три части: обучающую, валидационную и тестовую. Исходные данные разбиты в соотношении 3:1:1. Произведено масштабирование количественных признаков. Был замечен дисбаланс классов в целевом признаке, модели были изучены с/без учета данного факта, при этом использовались такие метрики как, accuracy, recall, precision, F-1 score, AUC-ROC. Для борьбы с дисбалансом использованы такие методы как: балансировка, увеличение выборки и уменьшение выборки.

Обучение моделей происходило с помощью модулей: Решающее дерево, Случайный лес, Логистическая регрессия, так как целевой признак - Exited — факт ухода клиента является категориальным, значит перед нами была задача классификации.

Лучший результат после увеличения выборки показала модель Random Forest Classifier при глубине = 11 и количестве деревьев = 60.

Обученная модель случайного леса образованная путем повторения несколько раз положительных объектов целевого признака - факт ухода клиента, получила самую высокую оценку F1 = 0.6483 и прошла проверку на адекватность, подтвержденная ее значением AUC-ROC = 0.8709. Это лучше, чем случайная модель предсказывания (AUC-ROC = 0.5). На тестовой выборке, которую была объединена с валидационной для увеличения количестваданных показала значение F1-меры - 0.6023, что соответствует критерию заказчика. Модель характеризуется высоким показателем точности = 0.8465, поэтому она с высокой вероятностью предсказывает уход клиента из банка.

## Стек технологий:

`pandas`, `matplotlib`, `numpy`, `seaborn`, `scikit-learn`, `imbalanced-learn`.

## Статус проекта:

Завершен.
